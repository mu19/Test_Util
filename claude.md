<목적>
자체 개발한 SW의 디버깅을 위해서 리눅스기반 서버 어플리케이션의 로그 파일과
윈도우 기반 클라이언트 어플리케이션의 로그파일을 손쉽게 취득하기 위한 유틸리티 개발

<개발 결과물>
윈도우(win11)용 사용자 어플리케이션

<기능>
1. 리눅스 시스템 SSH 및 SFTP를 통해 접근 및 파일 다운로드
2. 윈도우 프로그램 특정 경로의 로그 파일 복사
3. 파일 복사 또는 다운로드 전 파일 압축(옵션)
4. 다운로드 또는 복사된 파일은 삭제(옵션)
5. 추출 대상 로그 파일
  1) 리눅스 시스템 내부 커널 로그(디폴트 값은 우분투 배포판 커널 로그 저장 경로, 옵션에서 사용자가 변경 가능)
  2) 리눅스용 사용자 서버 어플리케이션 로그(경로는 옵션에서 설정)
  3) 윈도우용 사용자 클라이언트 어플리케이션 로그(경로는 옵션에서 설정)
6. 로그 파일 추출 현황을 프로그래스 바를 통해 출력
7. 각 폴더별로 로그 파일 삭제 명령어 실행용 버튼 필요(단, 삭제시 사용자에게 다시 한번 삭제 실행 여부 확인)
8. 리눅스 SSH 연결, 연결 종료 기능
9. SSH 연결 상태인 경우, 제한 시간을 초과하여 연결이 종료되지 않아야 함
10. 추출 대상 로그 파일 선정 방식
  1) 전체 추출(기본값)
  2) 파일 이름이 특정 형식으로 되어 있는 파일 추출(정규식 사용)
  3) 파일 생성 및 갱신 시간이 특정 시간 이후인 파일들 추출
11. 파일 다운로드시 메인 GUI가 멈추지 않도록 개발
12. 추출 대상 경로의 파일 목록을 볼 수 있는 기능
13. 추출 대상 경로의 파일 목록 중 사용자가 선택한 파일을 복사하거나 내려받는 기능
14. 추출된 로그 파일 저장 경로 설정 기능
15. 파일 다운로드 중 다운로드 강제 종료 기능


<개발 환경>
1. 사용 언어 및 버전 : python 3.13
2. GUI용 패키지 : wxPython
3. SSH 연결용 패키지 : paramiko

<배포 방식>
1. 단독 실행이 가능한 실행 파일 형태(.exe)
2. 배포된 파일을 사용자 PC에서 실행시 실행 시간에 오래 걸리지 않아야함
3. 콘솔창이 사용자에게 보이지 않도록 설정

<GUI 구성>
1. 메인 윈도우는 다이얼로그를 사용
2. 옵션 설정용 다이얼로그는 메인 다이얼로그와 분리(옵션은 메뉴에서 별도 실행)
3. 상태표시줄 출력(SSH 연결 상태, IP 주소 출력등)
4. 옵션 설정에 따라 컨트롤 활성화, 비활성화 처리
5. SSH 연결 상태에 따라 컨트롤 활성화, 비활성화 처리
6. 연관된 기능들은 그룹 컨트롤 그룹핑


<기타>
1. 향후 추가될 기능이 있으므로 확장성을 고려하여 설계

<구현 완료 현황>
## 핵심 인프라
- ✅ 설정 관리 시스템 (SettingsManager - Singleton 패턴)
  - JSON 기반 설정 저장/로드 ({프로그램폴더}/config/config.json)
  - SSH 설정, 로그 소스 설정, 저장 경로 관리
- ✅ SSH/SFTP 연결 관리자 (SSHManager)
  - Keep-alive 데몬 스레드로 연결 유지
  - 연결 타임아웃 및 재연결 처리
- ✅ 로깅 시스템
  - 일별 로그 파일 ({프로그램폴더}/logs/)
  - 로테이션 기능 (최대 30일, 10MB)
  - UI 로그 핸들러 통합 (모든 Python 로그가 UI에 실시간 출력)
- ✅ 데이터 모델
  - FileInfo, LogSourceConfig, SSHConfig, CollectionResult, ProgressInfo, CancelToken

## 파일 처리 엔진
- ✅ 파일 필터링 (FilterEngine)
  - 전체 필터
  - 정규식 필터
  - 날짜 기반 필터
- ✅ 로컬 파일 서비스 (LocalFileService)
  - 파일 목록 조회, 복사, 삭제
- ✅ 원격 파일 서비스 (RemoteFileService)
  - SFTP를 통한 파일 목록 조회, 다운로드, 삭제
  - 원격 서버에서 압축 후 다운로드 (tar.gz, gz)
  - 권한 오류 파일 처리 및 로깅
- ✅ 압축 처리 (CompressionHandler)
  - ZIP, tar.gz, gz 압축 (타임스탬프 기반 파일명)
  - 로그 타입별 압축 형식 자동 선택
  - 압축 파일명: controller_kernel_log_YYYY-MM-DD HH.MM.SS.gz
- ✅ 파일 수집 조정자 (FileCollector)
  - 전체 워크플로우 관리
  - 진행률 콜백 지원
  - 취소 토큰 처리
  - 원격 압축 통합 (압축 → 다운로드 → 삭제)

## UI 구성 요소
- ✅ 메인 프레임 (MainFrame)
  - 크기: 1000x800 (고정)
  - 3개 로그 소스별 제어 영역 (제어기 커널, 제어기, 사용자 SW)
  - 3행 레이아웃: 수집옵션 → 필터조건 → 실행버튼
  - 각 영역: 목록/수집/삭제 버튼
  - 전체 수집 버튼 (3가지 로그 모두 수집)
  - 진행률 표시 (프로그레스 바 + 텍스트)
  - 중지 버튼 (다운로드 중 활성화)
  - 상태 표시줄 (SSH 연결 상태, IP 주소)
  - 백그라운드 스레드 처리로 UI 응답성 유지
- ✅ 로그 윈도우 (LogWindow)
  - "보기 > 로그 메시지" 메뉴로 접근
  - 읽기 전용, 복사 가능
  - 로그 버퍼링 (최대 1000개)
  - 색상별 로그 레벨 표시
  - 지우기, 저장 기능
- ✅ 설정 다이얼로그 (SettingsDialog)
  - SSH 설정 (호스트, 포트, 계정, 타임아웃, keep-alive)
  - 로그 소스별 경로 설정
  - 저장 경로 설정
  - 압축/삭제 기본값 설정
  - 설정 유효성 검증
  - 저장 확인 다이얼로그
- ✅ 파일 목록 다이얼로그 (FileListDialog)
  - 파일 선택/해제 (더블클릭, 엔터)
  - 전체 선택/해제/토글 버튼
  - 파일 정보 표시 (이름, 크기, 수정 시간, 경로)
  - 선택 파일 수집 확인 (파일 개수, 총 크기)

## 주요 기능
- ✅ SSH 연결/해제
  - 백그라운드 스레드 처리 (UI 멈춤 방지)
  - 연결 중 상태 표시 (⏳ 연결 중...)
  - Keep-alive로 장시간 연결 유지
- ✅ 파일 목록 조회
  - 원격 (SSH를 통한 SFTP)
  - 로컬 (Windows 파일 시스템)
- ✅ 전체 파일 수집
  - 필터 적용 (전체/정규식/날짜)
  - 진행률 실시간 표시
  - 압축 옵션
  - 전송 후 삭제 옵션
- ✅ 선택 파일 수집
  - 파일 목록에서 선택한 파일만 수집
  - 확인 다이얼로그 (파일 개수, 총 크기)
- ✅ 파일 삭제
  - 파일 목록 조회 후 삭제
  - 확인 다이얼로그 (경고 메시지 포함)
  - 삭제 결과 표시 (성공/실패 개수)
- ✅ 취소 기능
  - CancelToken을 통한 작업 취소
  - 중지 버튼 (다운로드 중 활성화)
  - 현재 파일까지 수집 후 중단

## 아키텍처
- **Layer Architecture**: Presentation (UI) → Application (Services) → Domain (Core) → Infrastructure (Utils)
- **디자인 패턴**:
  - Singleton (SettingsManager)
  - Context Manager (SSHManager)
  - Observer (Progress Callback)
  - Factory (Filter Engine)
- **스레드 안전성**: wx.CallAfter()를 통한 UI 업데이트

## 설정 및 로그
- **설정 파일**: {프로그램폴더}\config\config.json
- **로그 파일**: {프로그램폴더}\logs\log_collector_YYYYMMDD.log
- **기본 저장 경로**: C:\Logs\collected (설정에서 변경 가능)

## 테스트
- 인프라 테스트: test_infrastructure.py
- SSH 테스트: test_ssh_manager.py, test_ssh_basic.py
- 통합 테스트 계획: TEST_PLAN.md (12개 시나리오, 체크리스트 포함)

## 의존성 패키지
- **wxpython** (4.2.3) - GUI 프레임워크
- **paramiko** (4.0.0) - SSH/SFTP 연결
- 간접 의존성: numpy, invoke, bcrypt, cryptography, pynacl, cffi, pycparser

## modification.md 구현 현황
✅ 모든 요구사항 (11개 + 추가 4개) 완료
- 메인윈도우 크기 고정 (1000x800)
- 명칭 변경 (제어기 커널/제어기/사용자 SW)
- 저장 경로 UI 제거
- 실시간 로그 윈도우
- 날짜 필터 힌트
- 3행 레이아웃
- 압축 옵션 제거
- 전체 수집 버튼
- 원격 파일 압축
- 압축 파일명 형식
- 도움말 메뉴 삭제
- 로그/설정 파일 위치 변경
- Python 로그 UI 출력
- 압축 실패 파일 로깅
- 의존성 최적화

## 다음 단계
1. ✅ modification.md 요구사항 모두 완료
2. 통합 테스트 수행
3. PyInstaller로 .exe 빌드
4. 배포 파일 테스트
