# Log Collector 테스트 계획서

## 개발 완료 기능 목록

### 1. 핵심 인프라
- ✅ 설정 관리 (SettingsManager)
- ✅ SSH/SFTP 연결 (SSHManager with keep-alive)
- ✅ 로깅 시스템
- ✅ 데이터 모델 (FileInfo, LogSourceConfig, etc.)

### 2. 파일 처리
- ✅ 파일 필터링 (전체/정규식/날짜)
- ✅ 로컬 파일 서비스
- ✅ 원격 파일 서비스 (SFTP)
- ✅ 압축 처리 (ZIP)
- ✅ 파일 수집 조정자

### 3. UI 구성 요소
- ✅ 메인 프레임 (로그 소스별 제어)
- ✅ 설정 다이얼로그
- ✅ 파일 목록 다이얼로그
- ✅ 진행률 표시 (프로그레스 바)
- ✅ 상태 표시줄

### 4. 주요 기능
- ✅ SSH 연결/해제 (백그라운드 스레드)
- ✅ 파일 목록 조회
- ✅ 전체 수집 (필터 적용)
- ✅ 선택 파일 수집
- ✅ 파일 삭제 (확인 메시지 포함)
- ✅ 압축 옵션
- ✅ 삭제 후 처리 옵션
- ✅ 취소 기능 (CancelToken)
- ✅ 실시간 진행 상황 표시

---

## 테스트 시나리오

### 시나리오 1: SSH 연결 테스트
**목적**: SSH 연결 및 keep-alive 기능 검증

**테스트 단계**:
1. 애플리케이션 실행
2. 설정에서 SSH 정보 입력 (127.0.0.1, pst, manager!1)
3. "연결" 버튼 클릭
4. 연결 상태 확인 (상태 표시줄: "✓ 연결됨 (127.0.0.1:22)")
5. 5분 이상 대기하여 keep-alive 동작 확인
6. "해제" 버튼 클릭
7. 연결 해제 확인 (상태 표시줄: "○ 미연결")

**예상 결과**:
- 연결 시도 중 "⏳ 연결 중..." 표시
- 연결 성공 시 녹색 상태 표시
- 장시간 대기 시에도 연결 유지
- 연결 해제 시 회색 상태 표시

---

### 시나리오 2: 파일 목록 조회 (원격)
**목적**: SSH를 통한 원격 파일 목록 조회 검증

**전제 조건**: SSH 연결 완료

**테스트 단계**:
1. Linux 커널 로그 영역의 "목록" 버튼 클릭
2. 파일 목록 다이얼로그 확인
3. 파일명, 크기, 수정 시간, 경로 정보 확인
4. 여러 파일 선택 (더블클릭 또는 엔터)
5. 선택 토글 버튼 테스트
6. 전체 선택/해제 버튼 테스트

**예상 결과**:
- 파일 목록이 정확히 표시됨
- 선택된 파일은 녹색 배경 + "✓" 표시
- 버튼들이 정상 동작

---

### 시나리오 3: 선택 파일 수집 (원격)
**목적**: 선택한 파일만 다운로드하는 기능 검증

**전제 조건**: SSH 연결 + 파일 목록 조회 완료

**테스트 단계**:
1. 파일 목록에서 2-3개 파일 선택
2. "수집" 버튼 클릭
3. 확인 다이얼로그에서 파일 개수 및 총 크기 확인
4. "예" 클릭
5. 진행률 표시 확인 (프로그레스 바 + 텍스트)
6. 수집 완료 메시지 확인
7. 저장 경로에서 파일 확인

**예상 결과**:
- 확인 다이얼로그에 정확한 정보 표시
- 진행률이 실시간으로 업데이트됨
- 파일이 정상적으로 다운로드됨
- 완료 메시지 표시

---

### 시나리오 4: 전체 수집 (필터 옵션)
**목적**: 필터 적용 후 전체 파일 수집 검증

**테스트 케이스 4-1: 전체 수집**
1. 설정에서 필터 타입을 "전체"로 설정
2. Linux 서버 로그 영역의 "전체" 버튼 클릭
3. 진행률 확인
4. 모든 파일이 수집되는지 확인

**테스트 케이스 4-2: 정규식 필터**
1. 설정에서 필터 타입을 "정규식"으로 설정
2. 필터 값: `log_\d{4}\.txt` (예시)
3. "전체" 버튼 클릭
4. 패턴에 맞는 파일만 수집되는지 확인

**테스트 케이스 4-3: 날짜 필터**
1. 설정에서 필터 타입을 "날짜"로 설정
2. 필터 값: `2025-10-01` (예시)
3. "전체" 버튼 클릭
4. 해당 날짜 이후 파일만 수집되는지 확인

---

### 시나리오 5: 압축 옵션 테스트
**목적**: 수집 후 압축 기능 검증

**테스트 단계**:
1. 설정에서 "파일 압축" 체크박스 활성화
2. 파일 수집 실행 (전체 또는 선택)
3. 진행률 확인 (압축 단계 포함)
4. 저장 경로에서 ZIP 파일 생성 확인
5. ZIP 파일 내용 확인 (모든 파일 포함 여부)
6. 원본 파일이 삭제되었는지 확인 (ZIP만 남아있어야 함)

**예상 결과**:
- `{source_type}_YYYYMMDD_HHMMSS.zip` 형식의 파일 생성
- ZIP 파일에 모든 수집 파일 포함
- 압축 후 로컬 원본 파일 삭제됨

---

### 시나리오 6: 삭제 후 처리 옵션 테스트
**목적**: 수집 후 원본 파일 삭제 기능 검증

**주의**: 이 테스트는 중요한 파일이 아닌 테스트용 파일로만 진행!

**테스트 단계**:
1. 설정에서 "전송 후 삭제" 체크박스 활성화
2. 파일 수집 실행
3. 수집 완료 후 로그 확인 (삭제 작업 로그)
4. 원격/로컬 경로에서 원본 파일이 삭제되었는지 확인

**예상 결과**:
- 수집 성공한 파일만 삭제됨
- 삭제 실패 시 로그에 경고 기록
- 수집 실패한 파일은 삭제되지 않음

---

### 시나리오 7: 파일 삭제 기능
**목적**: 파일 목록에서 직접 삭제하는 기능 검증

**주의**: 테스트용 파일로만 진행!

**테스트 단계**:
1. 파일 목록 조회
2. "삭제" 버튼 클릭
3. 확인 다이얼로그 확인:
   - 파일 개수
   - 총 크기
   - 경로
   - 경고 메시지
4. "아니오" 클릭하여 취소 테스트
5. 다시 "삭제" 버튼 클릭
6. "예" 클릭
7. 삭제 진행 중 표시 확인
8. 삭제 결과 다이얼로그 확인 (성공/실패 개수)
9. 원격/로컬 경로에서 파일 삭제 확인

**예상 결과**:
- 확인 다이얼로그에 상세 정보 표시
- 경고 아이콘 + "되돌릴 수 없습니다" 메시지
- 삭제 진행 중 프로그레스 바 표시
- 삭제 결과 정확히 표시

---

### 시나리오 8: 취소 기능 테스트
**목적**: 파일 수집 중 취소 기능 검증

**테스트 단계**:
1. 큰 파일 또는 많은 파일 수집 시작
2. 진행 중 "중지" 버튼 클릭
3. "취소 중..." 메시지 확인
4. 취소 완료 메시지 확인
5. 부분적으로 수집된 파일 확인

**예상 결과**:
- "중지" 버튼이 수집 중에만 활성화됨
- 취소 시 현재 파일까지만 수집됨
- 에러 없이 깔끔하게 종료됨
- 부분 수집 파일은 저장 경로에 남음

---

### 시나리오 9: 로컬 파일 수집 (Windows)
**목적**: 로컬 Windows 파일 복사 기능 검증

**전제 조건**: 설정에서 Windows 클라이언트 로그 경로 설정

**테스트 단계**:
1. Windows 클라이언트 로그 영역의 "목록" 버튼 클릭
2. 로컬 파일 목록 확인
3. 파일 선택 및 "수집" 버튼 클릭
4. 또는 "전체" 버튼으로 전체 수집
5. 진행률 확인
6. 저장 경로에서 파일 복사 확인

**예상 결과**:
- SSH 연결 없이도 동작
- 로컬 파일 복사가 빠르게 완료됨
- 파일 내용이 정확히 복사됨

---

### 시나리오 10: 설정 저장 및 로드
**목적**: 설정 저장/로드 기능 검증

**테스트 단계**:
1. 설정 메뉴 열기
2. 모든 설정 항목 변경:
   - SSH 정보
   - 로그 경로들
   - 저장 경로
   - 압축/삭제 옵션
3. "확인" 버튼 클릭
4. 저장 확인 다이얼로그에서 "예" 클릭
5. 애플리케이션 종료
6. 애플리케이션 재시작
7. 설정 메뉴 열어서 저장된 값 확인

**예상 결과**:
- 설정 파일 위치: `%APPDATA%\LogCollector\config.json`
- 모든 설정이 정확히 저장됨
- 재시작 후 설정이 복원됨

---

### 시나리오 11: 에러 처리 테스트
**목적**: 다양한 에러 상황 대응 검증

**테스트 케이스 11-1: 잘못된 SSH 정보**
1. 잘못된 IP/포트/계정 정보로 연결 시도
2. 에러 메시지 확인

**테스트 케이스 11-2: 존재하지 않는 경로**
1. 설정에서 존재하지 않는 로그 경로 입력
2. 파일 목록 조회 시도
3. 에러 메시지 확인

**테스트 케이스 11-3: 디스크 공간 부족**
(시뮬레이션 어려움 - 로그로만 확인)

**테스트 케이스 11-4: 네트워크 단절**
1. 수집 중 네트워크 연결 끊기
2. 에러 처리 및 복구 확인

**예상 결과**:
- 모든 에러에 대해 명확한 메시지 표시
- 애플리케이션이 강제 종료되지 않음
- 에러 로그 파일에 상세 정보 기록

---

### 시나리오 12: 동시성 테스트
**목적**: 백그라운드 작업 중 UI 응답성 검증

**테스트 단계**:
1. 대용량 파일 수집 시작
2. 수집 중 다른 UI 요소 조작 시도:
   - 다른 로그 소스의 목록 버튼
   - 설정 메뉴
   - 창 이동/리사이즈
3. UI가 멈추지 않는지 확인

**예상 결과**:
- 파일 다운로드 중에도 UI가 반응함
- 동시에 여러 작업 시도 시 적절한 경고 메시지
- 스레드 안전성 확보

---

## 로그 확인

**로그 파일 위치**: `%APPDATA%\LogCollector\logs\log_collector_YYYYMMDD.log`

**로그 레벨**:
- INFO: 정상 동작 흐름
- WARNING: 주의가 필요한 상황
- ERROR: 에러 발생
- DEBUG: 디버깅 정보

**로그 확인 방법**:
```batch
show_logs.bat
```

---

## 성능 기준

- **SSH 연결 시간**: <3초 (로컬 네트워크)
- **파일 목록 조회**: <2초 (100개 파일 기준)
- **로컬 파일 복사**: >10MB/s
- **원격 파일 다운로드**: 네트워크 속도에 의존
- **UI 응답 시간**: <100ms (모든 버튼 클릭)
- **메모리 사용량**: <200MB (대용량 파일 제외)

---

## 테스트 완료 체크리스트

### 기본 기능
- [ ] SSH 연결/해제
- [ ] Keep-alive 동작 (5분+)
- [ ] 원격 파일 목록 조회
- [ ] 로컬 파일 목록 조회
- [ ] 선택 파일 수집 (원격)
- [ ] 선택 파일 수집 (로컬)
- [ ] 전체 파일 수집
- [ ] 파일 삭제 기능

### 필터 기능
- [ ] 전체 필터
- [ ] 정규식 필터
- [ ] 날짜 필터

### 옵션 기능
- [ ] 파일 압축
- [ ] 전송 후 삭제
- [ ] 압축 + 삭제 조합

### UI/UX
- [ ] 진행률 표시
- [ ] 취소 기능
- [ ] 상태 표시줄
- [ ] 설정 저장/로드
- [ ] 에러 메시지
- [ ] 확인 다이얼로그

### 안정성
- [ ] 에러 처리
- [ ] 백그라운드 스레드
- [ ] UI 응답성
- [ ] 메모리 누수 없음
- [ ] 로그 기록

---

## 다음 단계: .exe 빌드

테스트 완료 후 PyInstaller로 실행 파일 빌드 예정:

```bash
uv run pyinstaller --name="LogCollector" ^
    --onefile ^
    --windowed ^
    --icon=icon.ico ^
    --add-data "config;config" ^
    main.py
```

**빌드 후 테스트**:
- [ ] 단독 실행 가능
- [ ] 빠른 시작 시간
- [ ] 콘솔창 숨김
- [ ] 모든 기능 정상 동작
