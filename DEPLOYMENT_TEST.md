# 배포 파일 테스트 가이드

**빌드 날짜**: 2025-10-23
**빌드 버전**: v0.1
**빌드 모드**: `--onedir` (폴더 배포 방식)
**콘솔**: `--noconsole` (콘솔창 숨김)

---

## 📦 빌드 결과 확인

### 빌드 출력 위치
```
dist/LogCollector/
├── LogCollector.exe       # 실행 파일 (약 5MB)
├── _internal/             # 의존성 라이브러리 폴더 (약 100-200MB)
│   ├── *.dll             # Windows 라이브러리
│   ├── *.pyd             # Python 확장 모듈
│   └── ...               # 기타 의존성 파일
├── config/                # 설정 파일 폴더 (최초 실행 시 자동 생성)
│   └── config.json       # 사용자 설정 파일
└── logs/                  # 로그 파일 폴더 (최초 실행 시 자동 생성)
    └── log_collector_YYYYMMDD.log
```

### 체크리스트 ✅
- [ ] `dist/LogCollector/` 폴더 존재 확인
- [ ] `LogCollector.exe` 파일 존재 (약 5MB)
- [ ] `_internal/` 폴더 존재 및 내용물 확인 (약 100-200MB)
- [ ] 파일 크기가 정상 범위 내에 있음

---

## ⚙️ 빌드 명령어 (참고)

### PyInstaller 빌드 실행
```bash
# 방법 1: spec 파일 사용 (권장)
pyinstaller log_collector.spec --clean

# 방법 2: python -m 사용
python -m PyInstaller log_collector.spec --clean
```

### spec 파일 주요 설정
- **name**: `LogCollector`
- **exclude_binaries**: `True` (--onedir 모드)
- **console**: `False` (콘솔창 숨김)
- **upx**: `True` (압축 활성화)

---

## 🧪 배포 파일 테스트

### 1단계: 기본 실행 테스트

#### 1-1. 실행 파일 확인
**테스트 단계**:
1. `dist/LogCollector/` 폴더로 이동
2. `LogCollector.exe` 더블클릭
3. 실행 시간 측정 (목표: 3초 이내)
4. 콘솔창이 표시되지 않는지 확인
5. 메인 윈도우가 정상적으로 표시되는지 확인 (1000x800)

**체크리스트**:
- [ ] 실행 시간 3초 이내
- [ ] 콘솔창 표시되지 않음 ✅
- [ ] 메인 윈도우 정상 표시 (1000x800 크기)
- [ ] 에러 메시지 없이 시작됨

**예상 결과**:
- 프로그램이 빠르게 시작됨
- 콘솔창 없이 GUI만 표시됨
- 메인 화면 정상 렌더링

---

#### 1-2. 자동 생성 폴더 확인
**테스트 단계**:
1. 프로그램 실행 후 종료
2. `config/` 폴더 생성 확인
3. `config/config.json` 파일 생성 확인
4. `logs/` 폴더 생성 확인
5. `logs/log_collector_YYYYMMDD.log` 파일 생성 확인

**체크리스트**:
- [ ] `config/` 폴더 자동 생성
- [ ] `config/config.json` 파일 생성
- [ ] `logs/` 폴더 자동 생성
- [ ] `logs/log_collector_YYYYMMDD.log` 파일 생성
- [ ] 파일 생성 권한 문제 없음

**예상 결과**:
- 프로그램 실행 폴더에 `config/`와 `logs/` 폴더 자동 생성
- 설정 파일과 로그 파일 정상 생성

---

### 2단계: Python 미설치 환경 테스트

#### 2-1. 단독 실행 확인
**테스트 환경**:
- Python이 설치되지 않은 PC
- 또는 Python 환경 변수를 제거한 상태

**테스트 단계**:
1. `dist/LogCollector/` 폴더 전체를 다른 PC로 복사
2. `_internal/` 폴더도 함께 복사되었는지 확인 ⚠️ **중요**
3. `LogCollector.exe` 실행
4. 정상 작동 확인

**체크리스트**:
- [ ] Python 미설치 환경에서 실행 가능
- [ ] `_internal/` 폴더 필수 동봉 확인
- [ ] 모든 기능 정상 작동
- [ ] 에러 메시지 없음

**예상 결과**:
- Python이 설치되지 않아도 정상 실행됨
- 모든 기능이 정상적으로 작동함

---

### 3단계: 핵심 기능 테스트

#### 3-1. SSH 연결 테스트
**테스트 단계**:
1. "파일 > 설정" 메뉴 열기
2. SSH 정보 입력 및 저장
3. "연결" 버튼 클릭
4. 상태 표시줄 확인: "✓ 연결됨 (IP:포트) | 원격(...): XX.XGB 가용 | 로컬: XX.XGB 가용"
5. 5분 이상 대기하여 keep-alive 확인
6. "해제" 버튼 클릭

**체크리스트**:
- [ ] SSH 연결 성공
- [ ] 상태 표시줄에 디스크 용량 표시
- [ ] Keep-alive 정상 작동 (5분 이상)
- [ ] 연결 해제 정상 작동

**예상 결과**:
- SSH 연결 및 keep-alive 정상 작동
- 디스크 용량 모니터링 정상 표시

---

#### 3-2. 파일 수집 테스트 (압축 활성화)
**테스트 단계**:
1. SSH 연결 완료
2. 설정에서 "파일 압축" 옵션 활성화
3. "제어기 커널 로그" 영역의 "수집" 버튼 클릭
4. 진행률 표시 확인
5. 로그 윈도우("보기 > 로그 메시지") 확인:
   - "원격 파일 압축 시작"
   - "원격 파일 압축 완료"
   - (권한 오류 시) "압축 실패" 경고
6. 저장 경로에 파일 확인:
   - `controller_kernel_log_YYYY-MM-DD HH.MM.SS.gz`

**체크리스트**:
- [ ] 원격 압축 정상 작동
- [ ] 압축 파일명 형식 올바름
- [ ] 권한 오류 파일 로깅됨
- [ ] 압축 완료 후 원격 압축 파일 삭제됨
- [ ] 저장 경로에 압축 파일 생성

**예상 결과**:
- 원격 서버에서 압축 후 다운로드
- 올바른 파일명 형식의 압축 파일 생성

---

#### 3-3. 파일 수집 테스트 (압축 비활성화)
**테스트 단계**:
1. 설정에서 "파일 압축" 옵션 비활성화
2. "제어기 로그" 영역의 "수집" 버튼 클릭
3. 저장 경로 확인:
   - 타임스탬프 폴더 생성: `controller_log_YYYY-MM-DD HH.MM.SS/`
   - 폴더 내 개별 파일들 확인
4. 원본 폴더 구조 유지 확인

**체크리스트**:
- [ ] 압축 없이 개별 파일 다운로드
- [ ] 타임스탬프 폴더 생성
- [ ] 폴더명 형식 올바름 (압축 파일명 규칙과 동일, 확장자 제거)
- [ ] 원본 폴더 구조 유지

**예상 결과**:
- 압축 없이 타임스탬프 폴더에 개별 파일 저장
- 원본 폴더 구조 유지

---

#### 3-4. 삭제 후 처리 옵션 테스트
**⚠️ 주의**: 테스트용 파일로만 진행!

**테스트 단계**:
1. 설정에서 "전송 후 삭제" 옵션 활성화
2. 파일 수집 실행
3. 로그에서 다음 메시지 확인:
   - "원본 파일 삭제 완료: 성공 X개"
   - "빈 디렉토리 정리 시작..."
   - "빈 디렉토리 삭제됨: [경로]"
   - "빈 디렉토리 정리 완료: X개 삭제"
4. 원격 서버에서 파일 및 빈 폴더 삭제 확인

**체크리스트**:
- [ ] 원본 파일 삭제됨
- [ ] 빈 폴더 자동 삭제됨
- [ ] 베이스 경로까지 상위로 올라가며 삭제
- [ ] 비어있지 않은 폴더는 유지됨
- [ ] 삭제 결과 로그 정확함

**예상 결과**:
- 파일 수집 후 원본 파일 및 빈 폴더 자동 삭제
- 비어있지 않은 폴더는 유지됨

---

#### 3-5. 전체 수집 버튼 테스트
**테스트 단계**:
1. "전체 수집" 버튼 클릭
2. 3가지 로그 순차 수집 확인:
   - 제어기 커널 로그
   - 제어기 로그
   - 사용자 SW 로그
3. 각 로그별 진행률 표시 확인
4. 저장 경로에 3개 파일 확인:
   - `controller_kernel_log_*.gz`
   - `controller_log_*.tar.gz`
   - `user_app_log_*.zip`

**체크리스트**:
- [ ] 3가지 로그 순차 수집
- [ ] 진행률 실시간 업데이트
- [ ] 올바른 압축 파일명 형식
- [ ] 완료 메시지 표시

**예상 결과**:
- 3가지 로그 모두 정상 수집
- 올바른 형식의 압축 파일 생성

---

#### 3-6. 로그 윈도우 테스트
**테스트 단계**:
1. "보기 > 로그 메시지" 메뉴 클릭
2. 로그 윈도우 표시 확인
3. Python 로그가 실시간으로 출력되는지 확인
4. 색상별 로그 레벨 확인 (INFO, WARNING, ERROR)
5. 로그 텍스트 복사 테스트
6. "지우기" 버튼 테스트
7. "저장" 버튼 테스트

**체크리스트**:
- [ ] 로그 윈도우 정상 표시
- [ ] Python 로그 실시간 출력 (모든 logging 메시지)
- [ ] 색상별 로그 레벨 구분
- [ ] 복사 기능 작동
- [ ] 지우기/저장 기능 작동

**예상 결과**:
- 모든 Python 로그가 실시간으로 UI에 출력됨
- 로그 레벨에 따라 색상 구분됨

---

### 4단계: UI/UX 테스트

#### 4-1. 백그라운드 작업 중 UI 응답성
**테스트 단계**:
1. 대용량 파일 수집 시작
2. 수집 중 UI 요소 조작:
   - 창 이동
   - 다른 버튼 클릭
   - 메뉴 열기
   - 로그 윈도우 스크롤
3. UI 반응 확인

**체크리스트**:
- [ ] 다운로드 중 UI 반응함
- [ ] 백그라운드 스레드 정상 작동
- [ ] 프로그램이 멈추지 않음 (응답 없음 상태 없음)

**예상 결과**:
- 파일 다운로드 중에도 UI가 부드럽게 작동함

---

#### 4-2. 취소 기능 테스트
**테스트 단계**:
1. 큰 파일 또는 많은 파일 수집 시작
2. 진행 중 "중지" 버튼 클릭
3. "취소 중..." 메시지 확인
4. 취소 완료 메시지 확인
5. 부분 수집 파일 확인

**체크리스트**:
- [ ] "중지" 버튼 수집 중 활성화
- [ ] 취소 정상 작동
- [ ] 현재 파일까지만 수집
- [ ] 에러 없이 종료

**예상 결과**:
- 취소 시 현재 파일까지만 수집하고 깔끔하게 종료됨

---

### 5단계: 설정 테스트

#### 5-1. 설정 저장/로드
**테스트 단계**:
1. "파일 > 설정" 메뉴 열기
2. 모든 설정 변경
3. "확인" 버튼 → 저장 확인 다이얼로그 "예"
4. 프로그램 종료
5. 프로그램 재시작
6. 설정 확인

**체크리스트**:
- [ ] 설정 저장 정상
- [ ] 재시작 후 설정 복원
- [ ] `config/config.json` 파일 내용 확인

**예상 결과**:
- 모든 설정이 파일에 저장되고 재시작 후 복원됨

---

#### 5-2. 원격 경로 찾아보기 버튼 제거 확인
**테스트 단계**:
1. "파일 > 설정" 메뉴 열기
2. "제어기 커널 로그 경로" 영역 확인
3. "제어기 로그 경로" 영역 확인
4. "사용자 SW 로그 경로" 영역 확인

**체크리스트**:
- [ ] 제어기 커널 로그: 찾아보기 버튼 없음 (텍스트 입력만)
- [ ] 제어기 로그: 찾아보기 버튼 없음 (텍스트 입력만)
- [ ] 사용자 SW 로그: 찾아보기 버튼 있음 (로컬 경로)

**예상 결과**:
- 원격 경로는 찾아보기 버튼 없이 텍스트 입력만 가능
- 로컬 경로만 찾아보기 버튼 표시

---

### 6단계: 에러 처리 테스트

#### 6-1. 잘못된 SSH 정보
**테스트 단계**:
1. 잘못된 IP/포트/계정으로 연결 시도
2. 에러 메시지 확인
3. 로그 파일에 에러 기록 확인

**체크리스트**:
- [ ] 명확한 에러 메시지 표시
- [ ] 프로그램 강제 종료되지 않음
- [ ] 에러 로그 파일에 기록

**예상 결과**:
- 에러 메시지 표시 후 정상 복구됨

---

#### 6-2. SSH 연결 없이 원격 작업 시도
**테스트 단계**:
1. SSH 연결하지 않은 상태
2. "제어기 커널 로그" > "목록" 버튼 클릭
3. 에러 메시지 확인

**체크리스트**:
- [ ] "먼저 SSH에 연결해주세요." 메시지 표시
- [ ] 프로그램이 정상적으로 동작함

**예상 결과**:
- 적절한 안내 메시지 표시

---

### 7단계: 성능 테스트

#### 7-1. 성능 기준 확인
**측정 항목**:
- 프로그램 시작 시간: 목표 <3초
- SSH 연결 시간: 목표 <3초 (로컬 네트워크)
- 파일 목록 조회: 목표 <2초 (100개 파일)
- UI 응답 시간: 목표 <100ms

**체크리스트**:
- [ ] 프로그램 시작 시간 3초 이내
- [ ] SSH 연결 시간 기준 충족
- [ ] 파일 목록 조회 속도 적절
- [ ] UI 응답성 양호

**예상 결과**:
- 모든 성능 기준 충족

---

### 8단계: Windows 호환성 테스트

#### 8-1. 다른 환경에서 테스트
**테스트 환경**:
- Windows 11 (기본)
- Windows 10 (가능 시)
- Python 미설치 PC
- 백신 소프트웨어 설치된 PC

**테스트 단계**:
1. `dist/LogCollector/` 폴더 전체를 다른 PC로 복사
2. `_internal/` 폴더가 함께 복사되었는지 확인 ⚠️ **필수**
3. 프로그램 실행 및 기본 기능 테스트

**체크리스트**:
- [ ] Python 미설치 PC에서 실행 가능
- [ ] 백신 오진 확인 (또는 예외 등록 안내)
- [ ] Windows 10/11에서 모두 실행 가능
- [ ] 폴더 전체 복사로 이동 가능

**예상 결과**:
- 다양한 Windows 환경에서 정상 작동

---

#### 8-2. 백신 소프트웨어 테스트
**테스트 단계**:
1. Windows Defender 또는 백신 소프트웨어 활성화
2. 프로그램 실행
3. 백신 경고 메시지 확인
4. 필요 시 예외 등록

**체크리스트**:
- [ ] 백신 경고 확인
- [ ] 예외 등록 방법 안내 필요 여부
- [ ] 예외 등록 후 정상 작동

**참고**: PyInstaller로 생성된 실행 파일은 백신이 오진할 수 있음

---

## 📊 최종 체크리스트

### 빌드 결과물
- [ ] `LogCollector.exe` 실행 파일 (약 5MB)
- [ ] `_internal/` 폴더 (약 100-200MB)
- [ ] 파일 크기 적절
- [ ] 폴더 구조 올바름

### 기본 실행
- [ ] 단독 실행 가능 (Python 미설치 환경)
- [ ] 실행 시간 3초 이내
- [ ] 콘솔창 숨김 ✅
- [ ] 메인 윈도우 정상 표시 (1000x800)

### 핵심 기능
- [ ] SSH 연결/해제
- [ ] 디스크 용량 모니터링 (원격 + 로컬)
- [ ] 원격 파일 압축 및 다운로드
- [ ] 압축 옵션 비활성화 시 개별 다운로드
- [ ] 타임스탬프 폴더 저장
- [ ] 빈 폴더 자동 삭제
- [ ] 파일 목록 조회
- [ ] 전체/선택 파일 수집
- [ ] 전체 수집 버튼
- [ ] 취소 기능

### UI/UX
- [ ] 백그라운드 스레드 정상 작동
- [ ] UI 응답성 양호
- [ ] 로그 윈도우 (Python 로그 실시간 출력)
- [ ] 진행률 표시
- [ ] 상태 표시줄 (디스크 용량 포함)

### 설정
- [ ] 설정 저장/로드 정상
- [ ] `config/config.json` 파일 생성
- [ ] 로그 파일 생성 (`logs/`)

### 안정성
- [ ] 에러 처리
- [ ] 프로그램 강제 종료 없음
- [ ] 로그 기록 정상

### 배포
- [ ] 폴더 전체 배포 가능
- [ ] `_internal/` 폴더 필수 동봉 ⚠️
- [ ] Python 미설치 환경 실행 가능
- [ ] 백신 오진 확인 및 대응 방안 안내

---

## 📝 테스트 결과 보고서 템플릿

```
# 배포 파일 테스트 결과 보고서

## 테스트 환경
- OS: Windows [버전]
- Python 설치 여부: [예/아니오]
- 백신 소프트웨어: [이름 및 버전]
- 테스트 일시: YYYY-MM-DD HH:MM
- 빌드 버전: v0.1
- 테스트 수행자: [이름]

## 빌드 결과물 확인
- LogCollector.exe 크기: [XX] MB
- _internal 폴더 크기: [XX] MB
- 파일 구조: [정상/비정상]

## 테스트 결과
- 전체 테스트 항목: X개
- 성공: X개
- 실패: X개
- 보류: X개

## 실패 항목
1. [항목명]: [실패 사유 및 재현 방법]
2. ...

## 성능 측정
- 프로그램 시작 시간: X초
- SSH 연결 시간: X초
- 파일 목록 조회: X초

## 백신 소프트웨어 호환성
- Windows Defender: [정상/경고/차단]
- 기타 백신: [정상/경고/차단]
- 예외 등록 필요 여부: [예/아니오]

## 발견된 버그
1. ...
2. ...

## 개선 사항
1. ...
2. ...

## 최종 평가
- [ ] 배포 승인
- [ ] 수정 필요
- [ ] 추가 테스트 필요

## 테스터 서명
- 서명: [이름]
- 날짜: YYYY-MM-DD
```

---

## 🚀 배포 방법

### 배포 패키지 생성
1. `dist/LogCollector/` 폴더 전체를 ZIP 파일로 압축
2. 파일명: `LogCollector_v0.1_YYYYMMDD.zip`
3. 압축 파일 내용:
   ```
   LogCollector/
   ├── LogCollector.exe
   ├── _internal/
   ├── README.md (선택)
   └── USER_GUIDE.md (선택)
   ```

### 사용자 배포 안내
1. **필수 안내 사항**:
   - `_internal/` 폴더는 실행 파일과 같은 위치에 있어야 함
   - 폴더 전체를 복사하여 사용
   - Python 설치 불필요

2. **백신 예외 등록 안내**:
   - PyInstaller로 생성된 파일은 백신이 오진할 수 있음
   - Windows Defender 예외 등록 방법 안내
   - 기타 백신 소프트웨어 예외 등록 안내

3. **최초 실행 안내**:
   - 첫 실행 시 `config/`와 `logs/` 폴더 자동 생성
   - 설정 메뉴에서 SSH 정보 및 경로 설정
   - 저장 경로 확인

---

## 📌 참고 사항

### --onedir 모드 특징
- **장점**:
  - 빠른 실행 속도 (압축 해제 불필요)
  - 낮은 백신 오진율
  - 쉬운 디버깅
- **단점**:
  - 파일 개수 많음 (폴더 전체 배포 필요)
  - 배포 크기 큼 (압축 시 해결)

### 주의사항
1. `_internal/` 폴더 누락 시 실행 불가
2. 폴더 전체를 배포해야 함
3. 백신 소프트웨어 예외 등록 필요할 수 있음
4. Windows Defender 예외 등록 권장

### 문제 발생 시
1. 로그 파일 확인 (`logs/log_collector_YYYYMMDD.log`)
2. `_internal/` 폴더 존재 여부 확인
3. 백신 소프트웨어 예외 등록
4. 프로그램 실행 경로 확인 (한글 경로 가능)
